<!DOCTYPE html>
<html lang="zh-cn"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3XR6QD9MQ2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3XR6QD9MQ2")</script><meta charset="utf-8"/><meta content="MlCbTFwi8qVmMCmDnlISOYdFqFcBTIA3hdWJIev8ljg" name="google-site-verification"/><meta content="IE=edge,chrome=1" http-equiv="x-ua-compatible"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Sswin" name="author"/><title>Some Verilog Tips ｜ SSWIN</title><meta content="" name="description"/><meta content="verilog,学习" name="keywords"/><meta content="summary" name="twitter:card"/><meta content="/posts/fc85bf3c/" name="twitter:site"/><meta content="Some Verilog Tips" name="twitter:creator"/><meta content="Some Verilog Tips" name="twitter:title"/><meta content="" name="twitter:description"/><meta content="https://bing.img.run/rand.php" name="twitter:image"/><meta content="Some Verilog Tips" property="og:title"/><meta content="/posts/fc85bf3c/" property="og:url"/><meta content="https://bing.img.run/rand.php" property="og:image"/><meta content="" name="og:description"/><meta content="Some Verilog Tips" property="og:site_name"/><meta content="article" property="og:type"/><meta content="" property="og:article:author"/><link href="https://thispersondoesnotexist.com/image" rel="shortcut icon"/><link href="https://zozo.sswin.site/css/normalize.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://zozo.sswin.site/css/zozo.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" media="screen" rel="stylesheet" type="text/css"/><link href="https://zozo.sswin.site/css/highlight.css" media="screen" rel="stylesheet" type="text/css"/><script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>
<link href="https://unpkg.com/@waline/client@v2/dist/waline.css" rel="stylesheet"/></head><body><div class="main animate__animated animate__fadeInDown"><div class="header animated fadeInDown"><div class="site_title_container"><div class="site_title"><a href="https://zozo.sswin.site/"><img alt="SSWIN" src="https://thispersondoesnotexist.com/image" style="border-radius:50px;width:100"/></a></div><div class="description"><p class="sub_title">放进时光蛋里。</p><div class="my_socials"><a href="mailto://me@sswin.site" target="_blank" title="mail"><i class="ri-mail-fill"></i></a>
<a href="//sms:me@sswin.site" target="_blank" title="phone"><i class="ri-phone-fill"></i></a>
<a href="//t.me/karl_s_bot" target="_blank" title="telegram"><i class="ri-telegram-fill"></i></a>
<a href="https://zozo.sswin.site/index.xml" target="_blank" title="rss" type="application/rss+xml"><i class="ri-rss-fill"></i></a></div></div></div></div><div class="content"><div class="post_page"><div class="post animate__animated animate__fadeInDown"><div class="post_title post_detail_title"><h2><a href="/posts/fc85bf3c/">Some Verilog Tips</a></h2><span class="date">2022.11.09</span></div><div class="post_content markdown"><h2 id="一module内部有效的定义"><strong>一、module内部有效的定义</strong></h2><p>用parameter来定义一个标志符代表一个常量，称作符号常量，他可以提高程序的可读性和可维护性。parameter是参数型数据的关键字，在每一个赋值语句的右边都必须是一个常数表达式。即该表达式只能包含数字或先前已经定义的参数。</p><p><code>parameter msb=7;</code> //定义参数msb=7</p><p><code>parameter r=5.7;</code> //定义r为一个实型参数5.7</p><p><code>parameter byte_size=8,byte_msb=byte_size-1;</code> //利用常数表达式赋值</p><p>参数型常量经常用于定义延迟时间和变量宽度。在模块和实例引用时，可以通过参数传递改变在被引用模块或实例中已经定义的参数。</p><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="mh">1</span> <span class="k">module</span> <span class="n">exam_prj</span>
</span></span><span class="line"><span class="cl"><span class="mh">2</span>     <span class="p">#(</span><span class="k">parameter</span> <span class="n">WIDTH</span><span class="o">=</span><span class="mh">8</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="mh">3</span>     <span class="c1">//端口内的参数只能在这使用 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mh">4</span>     <span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="mh">5</span>         <span class="k">input</span> <span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">dataa</span><span class="p">,</span><span class="c1">//[WIDTH-1:0]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mh">6</span>         <span class="k">input</span> <span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">datab</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="mh">7</span> 
</span></span><span class="line"><span class="cl"><span class="mh">8</span>         <span class="k">output</span> <span class="kt">reg</span> <span class="p">[</span><span class="nl">WIDTH:</span><span class="mh">0</span><span class="p">]</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl"><span class="mh">9</span>     <span class="p">);</span> 
</span></span><span class="line"><span class="cl">			<span class="k">parameter</span> <span class="n">Conuter_Top</span> <span class="o">=</span> <span class="mh">4</span><span class="mi">'d9</span><span class="p">;</span><span class="c1">//用于代码部分的参数
</span></span></span><span class="line"><span class="cl"><span class="c1">//代码部分省略
</span></span></span></code></pre></div><p>这里出现的两个参数parameter，第一个表示只在端口设置时使用，后面的是对于模块内部的使用。</p><blockquote><p><a href="https://www.cnblogs.com/uiojhi/p/7844879.html">verilog中参数传递与参数定义中#的作用</a></p></blockquote><h2 id="二generate语法举例">二、generate语法举例</h2><pre><code>generate
        genvar i;
        for(i=0;i&lt;=9;i=i+1) 
        begin
              assign D[i] = A[i];
        end
endgenerate
</code></pre><p>上述语句实现将<code>assign D[0]=A[0];assign D[1]=A[1];assign D[2]=A[2];·····assign D[9]=A[9];</code></p><p><a href="https://blog.csdn.net/yindq1220/article/details/123510892">system Verilog 中generate语法的灵活使用_希言自然也的博客-CSDN博客</a></p><h2 id="三verilog中-define-的使用">三、verilog中 `define 的使用</h2><h3 id="1背景">1、背景：</h3><p>　　在最近实战开发中发现：对外部芯片进行初始化时，往往需要定义大量参数。若直接在module中通过localparam或者parameter进行参数定义的话，会带来两个问题：</p><p>　　　　- 1.代码长度增加，不够美观；
　　　　- 2.不利于参数和代码修改；</p><p>　　为了解决这两个问题，我想到了在之前在《verilog数字系统设计教程》（夏闻宇）看到过的<code>define宏定义+</code>inlude “file.v"文件包含来实现参数模块化设计的方式。</p><h3 id="2实战">2、实战：</h3><h4 id="1新建参数模块文件我命名为parav">1.新建参数模块文件（我命名为para.v）；</h4><h4 id="2在parav文件中使用define宏定义参数部分有错误">2.在para.v文件中使用’define宏定义参数（部分、有错误）：</h4><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">//`define+name+参数 　
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">`define 　　STATE_INIT　　  3'd0;
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_IDLE　 　 3'd1;
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_WRIT　　 3'd2;
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_READ　　3'd3;
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_WORK   3'd4;
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_RETU　　3'd5;
</span></span></span></code></pre></div><h4 id="3在需要调用参数的文件initv中使用include-parav">3.在需要调用参数的文件init.v中使用`include “para.v”：</h4><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="no">`include</span> <span class="s">"para.v"</span>
</span></span></code></pre></div><h4 id="4在initv文件需要参数的地方使用name-调用部分">4.在init.v文件需要参数的地方使用`name 调用（部分）：</h4><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="n">state_init</span> <span class="o">&lt;=</span> <span class="no">`INIT_0</span><span class="p">;</span>
</span></span></code></pre></div><h4 id="5保存之后程序报错">5.保存之后，程序报错：</h4><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="nl">ERROR:HDLCompiler:</span><span class="mh">806</span> <span class="o">-</span> <span class="s">"F:/xilinx/pcm1864/v/init.v"</span> <span class="n">Line</span> <span class="mh">51</span><span class="o">:</span> <span class="n">Syntax</span> <span class="n">error</span> <span class="n">near</span> <span class="s">";"</span><span class="p">.</span>
</span></span><span class="line"><span class="cl"><span class="nl">ERROR:</span><span class="n">ProjectMgmt</span> <span class="o">-</span> <span class="mh">1</span> <span class="n">error</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">found</span> <span class="k">while</span> <span class="n">parsing</span> <span class="n">design</span> <span class="n">hierarchy</span><span class="p">.</span>
</span></span></code></pre></div><h4 id="6之后进行了两个多小时的调试一直没发现问题所在-最终在书上的案例中发现原因definename参数-之后不能加也就是说正确的代码应该是这样的">6.之后进行了两个多小时的调试（一直没发现问题所在= =），最终在书上的案例中发现原因：`define+name+参数 之后不能加”;",也就是说，正确的代码应该是这样的：</h4><div class="highlight"><pre class="chroma" tabindex="0"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="c1">//`define+name+参数 　
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">`define 　　STATE_INIT　　  3'd0
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_IDLE　 　 3'd1
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_WRIT　　 3'd2
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_READ　　3'd3
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_WORK   3'd4
</span></span></span><span class="line"><span class="cl"><span class="cp">`define 　　STATE_RETU　　3'd5
</span></span></span></code></pre></div><h4 id="7之后就都正确了">7.之后就都正确了。</h4><h3 id="3总结">3、总结：</h3><ul><li>1.`define+name+参数 之后不能加任何东西！</li><li>2.写代码一定要细心，细致！</li><li>3.当使用从未使用过的语句时，一定要先确定正确的用法！</li></ul><h3 id="4补充">4、补充：</h3><p>　　``define<code>与localparam和parameter最大的区别就是 </code>define可以跨文件传递参数；parameter只能在模块间传递参数；而localparam只能在其所在的module中起作用，不能参与参数传递。</p><p><a href="https://www.cnblogs.com/yjw951012/archive/2019/03/25/10595533.html">【基本知识】verilog中 `define 的使用 - 要努力做超人 - 博客园 (cnblogs.com)</a></p></div><div class="post_footer"><div class="meta"><div class="info"><span class="field tags"><i class="ri-stack-line"></i>
<a href="https://zozo.sswin.site/tags/verilog/">verilog</a>
<a href="https://zozo.sswin.site/tags/%E5%AD%A6%E4%B9%A0/">学习</a></span></div></div></div></div><script async="" crossorigin="anonymous" data-category="General" data-category-id="DIC_kwDOIgezUM4CTB6g" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="pathname" data-reactions-enabled="1" data-repo="winsight/hugo_zozo_comment" data-repo-id="R_kgDOIgezUA" data-strict="0" data-theme="light" src="https://giscus.app/client.js"></script></div></div></div><a class="back_to_top" href="#" id="back_to_top"><i class="ri-arrow-up-s-line"></i></a><footer class="footer"><div class="powered_by"><a href="https://timegg.top">SSWIN © 2022 ,</a>
<a href="http://www.gohugo.io/">Powered by Hugo.</a></div><div class="footer_slogan"><span>享受当下。</span></div></footer><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script src="https://zozo.sswin.site/js/jquery-3.5.1.min.js"></script>
<link href="https://zozo.sswin.site/css/fancybox.min.css" rel="stylesheet"/><script src="https://zozo.sswin.site/js/fancybox.min.js"></script>
<script src="https://zozo.sswin.site/js/zozo.js"></script></body></html>